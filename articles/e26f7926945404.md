---
title: "mockkã§privateé–¢æ•°ã®å¼•æ•°ã«anyã‚’æŒ‡å®šã—ãŸã„ã¨ã"
emoji: "ğŸ‘»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Kotlin", "Kotest", "mockk"]
published: true
---

# privateé–¢æ•°ã‚’ãƒ¢ãƒƒã‚¯åŒ–ã™ã‚‹

```kotlin:MockkTest.kt
class User(
    private val name: String
) {
    fun greet(word: String) = this.hello(word)

    private fun hello(word: String): String {
        val hello = "Hello, $name.\n"
        return hello + word
    }
}

internal class MockkTest : FunSpec({
    test("test hello mock") {
        val user = spyk(User("yamanaka"), recordPrivateCalls = true)
        every { user["hello"]("word") } returns "mock private function"

        user.greet("word") shouldBe "mock private function"
    }
})
```

- å¯¾è±¡ã®ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’spykã§ä½œæˆã™ã‚‹ã€‚
- `recordPrivateCalls = true`ã‚’æŒ‡å®šã™ã‚‹ã€‚
- `every { <ãƒ¢ãƒƒã‚¯å¯¾è±¡å¤‰æ•°>["privateé–¢æ•°å"](å¼•æ•°)}`ã®å½¢å¼ã§privateé–¢æ•°ã‚’ãƒ¢ãƒƒã‚¯åŒ–ã™ã‚‹ã€‚

# privateé–¢æ•°ã«anyã‚’æŒ‡å®šã™ã‚‹

```kotlin:MockkTest.kt
class User(
    private val name: String
) {
    fun greet(word: String) = this.hello(word)

    private fun hello(word: String): String {
        val hello = "Hello, $name.\n"
        return hello + word
    }
}

internal class MockkTest : FunSpec({
    test("test hello mock2") {
        val user = spyk(User("yamanaka"), recordPrivateCalls = true)
        every { user["hello"](any()) } returns "mock private function"

        user.greet("word") shouldBe "mock private function"
    }
})
```

ã“ã‚Œã§ã†ã¾ãã„ããã†ã ã‘ã©ã“ã‚Œã ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

# å¯¾ç­–
```kotlin:MockkTest.kt
class User(
    private val name: String
) {
    fun greet(word: String) = this.hello(word)

    private fun hello(word: String): String {
        val hello = "Hello, $name.\n"
        return hello + word
    }
}

internal class MockkTest : FunSpec({
    test("test hello mock3") {
        val user = spyk(User("yamanaka"), recordPrivateCalls = true)
        every { user["hello"](allAny<String>()) } returns "mock private function"

        user.greet("word") shouldBe "mock private function"
    }
})
```

`any()`ã§ã¯ãªã`allAny<String>()`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã†ã¾ãå‹•ä½œã™ã‚‹ã€‚

ä»¥ä¸Šï¼